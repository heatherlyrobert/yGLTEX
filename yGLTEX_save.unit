#!/usr/local/bin/koios
#   koios-polos (axis of heaven) unit testing meta-language



#23456789-12  123456789-123456789-123456789-12345  123456789-123456789-123456  123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-  123456789-  123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-  123456789-123456789- 
#==(verb)===  ===========(description)===========  =====(function)===========  ========================(arguments)=================================================================  ==(test)==  ==========================(results)=================================================================  ========(var)======= 
PREP          include the prototype headers                                      - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   - - - - -   - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
   incl       include public header                yGLTEX.h                    - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   - - - - -   - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
   incl       include private header               yGLTEX_priv.h               - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   - - - - -   - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  



#23456789-12  123456789-123456789-123456789-12345  123456789-123456789-123456  123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-  123456789-  123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-  123456789-123456789- 
#==(verb)===  ===========(description)===========  =====(function)===========  ========================(arguments)=================================================================  ==(test)==  ==========================(results)=================================================================  ========(var)======= 
SCRP          (SAVE) verify saving new header                                    0s   header          ygltex_save_header, ygltex_save_free                                         ((01.---))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  

   COND       initialize the testing environment                                 - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.001))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     start testing                        ygltex__unit_quiet                                                                                                                i_equal     0                                                                                                    
     local    create working variable              - - - - - - - - - - - - -   char         *x_name  = "/tmp/ygltex_test.txt";                                                                                                                                                                                
     local    create working variable              - - - - - - - - - - - - -   FILE         *f       = NULL;                                                                                                                                                                                                  
     local    create working variable              - - - - - - - - - - - - -   png_structp  *s       = NULL;                                                                                                                                                                                                  
     local    create working variable              - - - - - - - - - - - - -   png_infop    *i       = NULL;                                                                                                                                                                                                  

   COND       attempt to free a unused png header                                - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call free                            ygltex_save_free            &s       , &i                                                                                         i_lesser    0                                                                                                    
     echo     ... check structure                  - - - - - - - - - - - - -   s                                                                                                     p_null      0                                                                                                    
     echo     ... check info header                - - - - - - - - - - - - -   i                                                                                                     p_null      0                                                                                                    

   COND       attempt a png header without file open                             - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call header                          ygltex_save_header          f        , &s       , &i                                                                              i_lesser    0                                                                                                    
     echo     ... check structure                  - - - - - - - - - - - - -   s                                                                                                     p_null      0                                                                                                    
     echo     ... check info header                - - - - - - - - - - - - -   i                                                                                                     p_null      0                                                                                                    

   COND       open a new file for writing                                        - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call open                            ygltex_file_open            x_name         , 'W'      , NULL     , NULL     , &f                                                  i_equal     0                                                                                                    
     echo     ... check pointer                    - - - - - - - - - - - - -   f                                                                                                     p_exists    0                                                                                                    

   COND       attempt header with NULLs                                          - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call header                          ygltex_save_header          f        , NULL     , &i                                                                              i_lesser    0                                                                                                    
     echo     ... check structure                  - - - - - - - - - - - - -   s                                                                                                     p_null      0                                                                                                    
     echo     ... check info header                - - - - - - - - - - - - -   i                                                                                                     p_null      0                                                                                                    
     exec     call header                          ygltex_save_header          f        , &s       , NULL                                                                            i_lesser    0                                                                                                    
     echo     ... check structure                  - - - - - - - - - - - - -   s                                                                                                     p_null      0                                                                                                    
     echo     ... check info header                - - - - - - - - - - - - -   i                                                                                                     p_null      0                                                                                                    

   COND       verify saving an png header                                        - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call header                          ygltex_save_header          f        , &s       , &i                                                                              i_equal     0                                                                                                    
     echo     ... check structure                  - - - - - - - - - - - - -   s                                                                                                     p_exists    0                                                                                                    
     echo     ... check info header                - - - - - - - - - - - - -   i                                                                                                     p_exists    0                                                                                                    

   COND       attempt to reopen header                                           - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call header                          ygltex_save_header          f        , &s       , &i                                                                              i_lesser    0                                                                                                    
     echo     ... check structure                  - - - - - - - - - - - - -   s                                                                                                     p_exists    0                                                                                                    
     echo     ... check info header                - - - - - - - - - - - - -   i                                                                                                     p_exists    0                                                                                                    

   COND       verify freeing headers                                             - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call free                            ygltex_save_free            &s       , &i                                                                                         i_equal     0                                                                                                    
     echo     ... check structure                  - - - - - - - - - - - - -   s                                                                                                     p_null      0                                                                                                    
     echo     ... check info header                - - - - - - - - - - - - -   i                                                                                                     p_null      0                                                                                                    

   COND       close file                                                         - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call close                           ygltex_file_close           NULL     , NULL     , &f                                                                              i_equal     0                                                                                                    
     echo     ... check pointer                    - - - - - - - - - - - - -   f                                                                                                     p_null      0                                                                                                    

   COND       complete testing                                                   - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.003))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     stop testing                         ygltex__unit_end                                                                                                                  i_equal     0                                                                                                    



#23456789-12  123456789-123456789-123456789-12345  123456789-123456789-123456  123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-  123456789-  123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-  123456789-123456789- 
#==(verb)===  ===========(description)===========  =====(function)===========  ========================(arguments)=================================================================  ==(test)==  ==========================(results)=================================================================  ========(var)======= 
SCRP          (SAVE) verify saving attributes                                    0s   attrib          ygltex_save_attrib                                                           ((01.---))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  

   COND       initialize the testing environment                                 - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.001))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     start testing                        ygltex__unit_quiet                                                                                                                i_equal     0                                                                                                    
     local    create working variable              - - - - - - - - - - - - -   char         *x_name  = "/tmp/ygltex_test.txt";                                                                                                                                                                                
     local    create working variable              - - - - - - - - - - - - -   FILE         *f       = NULL;                                                                                                                                                                                                  
     local    create working variable              - - - - - - - - - - - - -   png_structp  *s       = NULL;                                                                                                                                                                                                  
     local    create working variable              - - - - - - - - - - - - -   png_infop    *i       = NULL;                                                                                                                                                                                                  
     local    create working variable              - - - - - - - - - - - - -   int           r       =    0;                                                                                                                                                                                                  

   COND       attempt to save with no file open                                  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call attrib                          ygltex_save_attrib          s        , i        , 100      , 200      , &r                                                        i_lesser    0                                                                                                    
     echo     ... check row bytes                  - - - - - - - - - - - - -   r                                                                                                     i_equal     0                                                                                                    

   COND       open a new file for writing                                        - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call open                            ygltex_file_open            x_name         , 'W'      , NULL     , NULL     , &f                                                  i_equal     0                                                                                                    
     echo     ... check pointer                    - - - - - - - - - - - - -   f                                                                                                     p_exists    0                                                                                                    

   COND       attempt to save with no header created                             - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call attrib                          ygltex_save_attrib          s        , i        , 100      , 200      , &r                                                        i_lesser    0                                                                                                    
     echo     ... check row bytes                  - - - - - - - - - - - - -   r                                                                                                     i_equal     0                                                                                                    

   COND       create a header                                                    - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call header                          ygltex_save_header          f        , &s       , &i                                                                              i_equal     0                                                                                                    
     echo     ... check structure                  - - - - - - - - - - - - -   s                                                                                                     p_exists    0                                                                                                    
     echo     ... check info header                - - - - - - - - - - - - -   i                                                                                                     p_exists    0                                                                                                    

   COND       verify saving attributes                                           - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call attrib                          ygltex_save_attrib          s        , i        , 100      , 200      , &r                                                        i_equal     0                                                                                                    
     echo     ... check row bytes                  - - - - - - - - - - - - -   r                                                                                                     i_equal     400                                                                                                  

   COND       complete testing                                                   - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.003))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     stop testing                         ygltex__unit_end                                                                                                                  i_equal     0                                                                                                    



#23456789-12  123456789-123456789-123456789-12345  123456789-123456789-123456  123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-  123456789-  123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-  123456789-123456789- 
#==(verb)===  ===========(description)===========  =====(function)===========  ========================(arguments)=================================================================  ==(test)==  ==========================(results)=================================================================  ========(var)======= 
SCRP          (SAVE) verify saving image                                         0s   image           ygltex_save_image                                                            ((01.---))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  

   COND       initialize the testing environment                                 - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.001))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     start testing                        ygltex__unit_quiet                                                                                                                i_equal     0                                                                                                    
     local    create working variable              - - - - - - - - - - - - -   char         *x_name  = "/tmp/ygltex_test.png";                                                                                                                                                                                
     local    create working variable              - - - - - - - - - - - - -   FILE         *f       = NULL;                                                                                                                                                                                                  
     local    create working variable              - - - - - - - - - - - - -   png_structp  *s       = NULL;                                                                                                                                                                                                  
     local    create working variable              - - - - - - - - - - - - -   png_infop    *i       = NULL;                                                                                                                                                                                                  
     local    create working variable              - - - - - - - - - - - - -   int           x_wide  =   10;                                                                                                                                                                                                  
     local    create working variable              - - - - - - - - - - - - -   int           x_tall  =   15;                                                                                                                                                                                                  
     local    create working variable              - - - - - - - - - - - - -   int          *r       =    0;                                                                                                                                                                                                  
     local    create working variable              - - - - - - - - - - - - -   png_byte     *x_image = NULL;                                                                                                                                                                                                 
     local    create working variable              - - - - - - - - - - - - -   png_bytep    *x_rows  = NULL;                                                                                                                                                                                                 

   COND       attempt to save before anything                                    - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     save image                           ygltex_save_image           s        , i        , x_image  , x_rows   , YGLTEX_IMAGE   , x_wide   , x_tall                        i_lesser    0                                                                                                    

   COND       open new image for writing                                         - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     remove file                          yURG_rm                     x_name                                                                                                i_equal     0                                                                                                    
     exec     call open                            ygltex_file_open            x_name         , 'W'      , NULL     , NULL     , &f                                                  i_equal     0                                                                                                    
     echo     ... check pointer                    - - - - - - - - - - - - -   f                                                                                                     p_exists    0                                                                                                    

   COND       attempt to save before header                                      - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     save image                           ygltex_save_image           s        , i        , x_image  , x_rows   , YGLTEX_IMAGE   , x_wide   , x_tall                        i_lesser    0                                                                                                    

   COND       create a new header                                                - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call header                          ygltex_save_header          f        , &s       , &i                                                                              i_equal     0                                                                                                    
     echo     ... check structure                  - - - - - - - - - - - - -   s                                                                                                     p_exists    0                                                                                                    
     echo     ... check info header                - - - - - - - - - - - - -   i                                                                                                     p_exists    0                                                                                                    
     exec     call attrib                          ygltex_save_attrib          s        , i        , x_wide   , x_tall   , &r                                                        i_equal     0                                                                                                    
     echo     ... check row bytes                  - - - - - - - - - - - - -   r                                                                                                     i_equal     40                                                                                                   

   COND       attempt to save before allocation                                  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     save image                           ygltex_save_image           s        , i        , x_image  , x_rows   , YGLTEX_IMAGE   , x_wide   , x_tall                        i_lesser    0                                                                                                    

   COND       allocate image                                                     - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call allocate                        ygltex_image_alloc          x_wide   , x_tall   , r        , &x_image , &x_rows                                                   i_equal     0                                                                                                    
     echo     ... check image                      - - - - - - - - - - - - -   x_image                                                                                               p_exists    0                                                                                                    
     echo     ... check rows                       - - - - - - - - - - - - -   x_rows                                                                                                p_exists    0                                                                                                    

   COND       verify saving the image                                            - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     save image                           ygltex_save_image           s        , i        , x_image  , x_rows   , YGLTEX_IMAGE   , x_wide   , x_tall                        i_equal     0                                                                                                    

   COND       free allocation                                                    - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call free                            ygltex_image_free           &x_image , &x_rows                                                                                    i_equal     0                                                                                                    
     echo     ... check image                      - - - - - - - - - - - - -   x_image                                                                                               p_null      0                                                                                                    
     echo     ... check rows                       - - - - - - - - - - - - -   x_rows                                                                                                p_null      0                                                                                                    

   COND       attempt to save after freeing                                      - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     save image                           ygltex_save_image           s        , i        , x_image  , x_rows   , YGLTEX_IMAGE   , x_wide   , x_tall                        i_lesser    0                                                                                                    

   COND       destroy data and close file                                        - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call free                            ygltex_save_free            &s       , &i                                                                                         i_equal     0                                                                                                    
     echo     ... check structure                  - - - - - - - - - - - - -   s                                                                                                     p_null      0                                                                                                    
     echo     ... check info header                - - - - - - - - - - - - -   i                                                                                                     p_null      0                                                                                                    
     exec     call close                           ygltex_file_close           NULL     , NULL     , &f                                                                              i_equal     0                                                                                                    
     echo     ... check file pointer               - - - - - - - - - - - - -   f                                                                                                     p_null      0                                                                                                    

   COND       attempt to save after destruction                                  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     save image                           ygltex_save_image           s        , i        , x_image  , x_rows   , YGLTEX_IMAGE   , x_wide   , x_tall                        i_lesser    0                                                                                                    

   COND       complete testing                                                   - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.003))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     stop testing                         ygltex__unit_end                                                                                                                  i_equal     0                                                                                                    


